<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GroceryOrderingApp.Mobile.Views.AdminProductsPage"
             Title="Manage Products"
             BackgroundColor="{StaticResource BackgroundColor}">
    
    <Grid RowDefinitions="Auto,*,Auto" VerticalOptions="FillAndExpand">
        
        <!-- Header -->
        <StackLayout Grid.Row="0" BackgroundColor="{StaticResource Primary}" Padding="20" Spacing="8">
            <Label Text="ðŸ¥¬ Manage Products" Style="{StaticResource HeadlineStyle}" 
                   TextColor="White" HorizontalTextAlignment="Center"/>
            <Label Text="Add, edit, or delete products" 
                   FontSize="12" TextColor="{StaticResource TextSecondary}" 
                   HorizontalTextAlignment="Center"/>
        </StackLayout>
        
        <!-- Loading Indicator -->
        <ActivityIndicator Grid.Row="1" 
                          IsRunning="{Binding IsLoading}" 
                          IsVisible="{Binding IsLoading}"
                          Color="{StaticResource Primary}"
                          Scale="1.8"
                          VerticalOptions="Center"/>
        
        <!-- Products List -->
        <CollectionView Grid.Row="1" 
                       ItemsSource="{Binding Products}"
                       Padding="12"
                       VerticalOptions="FillAndExpand"
                       IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Style="{StaticResource CardStyle}" 
                           HasShadow="True"
                           Padding="12"
                           Margin="0,6"
                           BorderColor="{StaticResource Secondary}">
                        
                        <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="*,Auto" RowSpacing="8" ColumnSpacing="12">
                            <!-- Product Name -->
                            <Label Grid.Row="0" Grid.Column="0"
                                  Text="{Binding Name}"
                                  FontSize="14" FontAttributes="Bold"
                                  TextColor="{StaticResource TextPrimary}"/>
                            <Label Grid.Row="0" Grid.Column="1"
                                  Text="{Binding Id, StringFormat='ID: {0}'}"
                                  FontSize="11" TextColor="{StaticResource TextHint}"/>
                            
                            <!-- Price & Stock -->
                            <Label Grid.Row="1" Grid.Column="0"
                                  Text="{Binding Price, StringFormat='â‚¹{0:F2}'}"
                                  FontSize="13" TextColor="{StaticResource Success}"/>
                            <Label Grid.Row="1" Grid.Column="1"
                                  Text="{Binding StockQuantity, StringFormat='Stock: {0}'}"
                                  FontSize="11" TextColor="{StaticResource TextSecondary}"/>
                            
                            <!-- Delete Button -->
                            <Button Grid.Row="2" Grid.ColumnSpan="2"
                                   Text="ðŸ—‘ Delete Product"
                                   Style="{StaticResource DangerButtonStyle}"
                                   FontSize="11"
                                   Padding="8"
                                   Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteProductCommand}"
                                   CommandParameter="{Binding Id}"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        
        <!-- Error Message -->
        <Label Grid.Row="1"
               Text="{Binding ErrorMessage}"
               TextColor="{StaticResource Error}"
               FontSize="14"
               LineBreakMode="WordWrap"
               Padding="20"
               HorizontalTextAlignment="Center"
               VerticalOptions="Center"
               IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBool}}"/>
        
        <!-- Refresh Button -->
        <Frame Grid.Row="2"
               Style="{StaticResource CardStyle}"
               HasShadow="True"
               Padding="12"
               CornerRadius="8"
               Margin="12,0,12,12">
            <Button Text="ðŸ”„ Refresh Products"
                   Style="{StaticResource PrimaryButtonStyle}"
                   FontSize="14"
                   Padding="12"
                   Command="{Binding RefreshCommand}"/>
        </Frame>
    </Grid>
    
</ContentPage>
